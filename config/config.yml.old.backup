environment: production
configVersion: 2

# Logging
logging:
  directory: logs
  logRotatePattern: YYYY-MM-DD
  maxRetainedFiles: 10
  maxFileSizeMB: 15
  compressOnRotation: false
  useUTC: true

# Connectors
connectors:
  - file: connectorRIS
    name: ris
    params:
      url: ws://ris-live.ripe.net/v1/ws/
      perMessageDeflate: true
      carefulSubscription: true
      includeRaw: false
      subscription:
        type: UPDATE
        moreSpecific: true

# Monitors
monitors:
  - file: monitorHijack
    channel: hijack
    name: basic-hijack-detection
    params:
      thresholdMinPeers: 3

  - file: monitorNewPrefix
    channel: newprefix
    name: new-prefix-detection
    params:
      thresholdMinPeers: 3

  - file: monitorVisibility
    channel: visibility
    name: withdrawal-detection
    params:
      thresholdMinPeers: 40

  - file: monitorPath
    channel: path
    name: path-matching
    params:
      thresholdMinPeers: 1

  - file: monitorAS
    channel: misconfiguration
    name: asn-monitor
    params:
      thresholdMinPeers: 3
      skipPrefixMatch: false

  - file: monitorRPKI
    channel: rpki
    name: rpki-monitor
    params:
      thresholdMinPeers: 3
      checkUncovered: false
      checkDisappearing: false

  - file: monitorROAS
    channel: roa
    name: rpki-diff
    params:
      enableDiffAlerts: true
      enableExpirationAlerts: true
      roaExpirationAlertHours: 24

# Reports
reports:
  - file: reportFile
    channels: [hijack, newprefix, visibility, path, misconfiguration, rpki, roa]
    params:
      persistAlertData: false
      alertDataDirectory: alertdata/

  - file: reportEmail
    channels: [hijack, newprefix, visibility, path, misconfiguration, rpki, roa]
    params:
      senderEmail: "bgpalerter@onwave.com"
      smtp:
        host: "onwave-com.mail.protection.outlook.com"
        port: 25
        secure: false
      notifiedEmails:
        default:
          - "iain.murdoch@onwave.com"

# Prefixes & groups
monitoredPrefixesFiles:
  - prefixes.yml

groupsFile: groups.yml

# RPKI
rpki:
  vrpProvider: rpkiclient
  refreshVrpListMinutes: 15
  markDataAsStaleAfterMinutes: 120

# REST API
rest:
  host: 0.0.0.0
  port: 8011

# Process monitoring for health checks
processMonitors:
  - file: uptimeApi
    params:
      useStatusCodes: true
